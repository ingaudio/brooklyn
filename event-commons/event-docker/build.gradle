
version='0.1.0'

task cleanAll(dependsOn:['dockerClean']) {
	doLast {}
}

task dockerDataClean {
	doLast {
		delete "${projectDir}/solr/cores/eventCore/data"
	}
}

task dockerClean(dependsOn:['dockerDataClean']) {
	doLast {
		project.exec { ExecSpec e ->
			e.commandLine composeCommand('rm','-f', '-a', '-v')
		}
	}
}

task dockerBuild {
	doLast {
		project.exec { ExecSpec e ->
			e.commandLine composeCommand('build')
		}
	}
}

task dockerUp(dependsOn:['dockerBuild']) {
	doLast {
		project.exec { ExecSpec e ->
			e.commandLine composeCommand('up')
		}
	}
}

task dockerDown {
	doLast {
		project.exec { ExecSpec e ->
			e.commandLine composeCommand('down')
		}
	}
}

Iterable<String> composeCommand(String... args) {
	def res = ['docker-compose']
	res.addAll(args)
	res
}